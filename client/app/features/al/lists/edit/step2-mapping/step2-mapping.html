<h3 class="title_section">List: <span>{{$ctrl.listName}}</span></h3>
<abx-message msg="$ctrl.message"></abx-message>
<div ng-if="!$ctrl.canMapping">Sorry you need a file to map</div>
<div ng-if="$ctrl.canMapping">
    <abx-load-indicator ng-show="$ctrl.contactFields.length==0" text="Loading Contacts Fields"></abx-load-indicator>
    <div ng-show="$ctrl.contactFields.length>0">
        <p>Set mapping from source fields to Contact fields</p>
        <div class="well well-sm">
            <fieldset>
                <button ng-click="$ctrl.matchSmart()" ng-disabled="!$ctrl.hasHeader">Smart Mapping</button>
                <button ng-click="$ctrl.clearMapping()" ng-disabled="!$ctrl.hasHeader">Clear mapping</button> <br/>
            </fieldset>
            <fieldset>
                Contact Field
                <select ng-model="$ctrl.contactFieldSelectedName" ng-options="str.name for str in $ctrl.contactFieldsNames"></select>
                <button ng-click="$ctrl.addMappingItem()" disabled>Add mapping item</button>
                <button ng-click="$ctrl.removeSelectedItem()">Remove selected items</button>
            </fieldset>
        </div> 
        <div class="well well-sm">
            <div class="row">
                <div class="col-md-4">
                    <label>Delimiter:</label>
                    <select name="del" ng-model="$ctrl.selectedDelimiter" ng-change="$ctrl.changeDelimiter()" ng-options="delimiter.title for delimiter in $ctrl.delimiters"></select>
                </div>
                <div class="col-md-4">
                    <label for="delimiter">Custom:</label>
                    <input type="text" ng-model="$ctrl.selectedSymbolDelimiter" maxlength="1" ng-change="$ctrl.changeDelimiter()" ng-disabled="!$ctrl.customDelimiterEnabled">
                </div>
                <div class="col-md-4">
                    <label>
                <input type="checkbox" ng-model="$ctrl.hasHeader" ng-change="$ctrl.changeHeaderValue()">
                Has Header</label>
                </div>
            </div>
        </div>
        <table class="table table-striped table-condensed table-selectable">
            <thead>
                <th width="150">Source Field
                    <span ng-show="$ctrl.hasHeader">Name</span>
                    <span ng-show="!$ctrl.hasHeader">Index</span>
                </th>
                <th>Contact Field</th>
                <th width="100" class="text-center">
                    Key
                </th>
            </thead> 
            <tbody>
                <tr ng-repeat="field in $ctrl.contactFields track by $index" ng-click="$ctrl.selectedRow=$index" ng-class="{'rowselected':$ctrl.selectedRow==$index}">
                    <td>
                        <select class="cell-select" ng-if="$ctrl.hasHeader" ng-model="field.mappedName" ng-options="o for o in $ctrl.jsonCSV[0]">
                    <option value=''>==</option>
                 </select>
                        <abx-number-updown class="number-updown-width" ng-model="field.mappedIndex" max-value="$ctrl.maxIndexFields" ng-if="!$ctrl.hasHeader"></abx-number-updown>
                    </td>
                    <td>{{field.name}}</td>
                    <td class="text-center">                        
                        <input ng-if="field.isKey!=undefined" class="cell-checkbox" type="checkbox" ng-model="field.isKey">
                    </td>
                </tr>
            </tbody>
        </table>
        <div style="    margin-bottom: 36px;">
             <button ng-click="$ctrl.showState()">State</button>
             <button ng-click="$ctrl.finishMap()">Finish</button>
        </div>       
    </div>
</div>